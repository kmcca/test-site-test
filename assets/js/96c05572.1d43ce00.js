"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[25018],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=o,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(g,i(i({ref:t},c),{},{components:n})):a.createElement(g,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},76536:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(87462),o=(n(67294),n(3905));const r={title:"Go Packaging",slug:"/r/compilation_go"},i=void 0,l={unversionedId:"guides/packaging/go",id:"guides/packaging/go",title:"Go Packaging",description:"Your Go applications must meet specific compilation requirements before you can submit them for scanning.",source:"@site/docs/guides/03_packaging/12_go.md",sourceDirName:"guides/03_packaging",slug:"/r/compilation_go",permalink:"/km-docusaurus-test/r/compilation_go",draft:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{title:"Go Packaging",slug:"/r/compilation_go"},sidebar:"tutorialSidebar",previous:{title:"Dart and Flutter Packaging",permalink:"/km-docusaurus-test/r/Dart_and_Flutter_Application_Packaging"},next:{title:"Groovy Packaging",permalink:"/km-docusaurus-test/r/c_compilation_groovy"}},p={},s=[{value:"Supported Go Versions",id:"supported-go-versions",level:2},{value:"Supported Go Frameworks and Libraries",id:"supported-go-frameworks-and-libraries",level:2},{value:"Packaging Guidance for Go",id:"packaging-guidance-for-go",level:2},{value:"Software Composition Analysis Requirements",id:"software-composition-analysis-requirements",level:2},{value:"Upload Requirements",id:"upload-requirements",level:2},{value:"Configuration for Different Structures",id:"configuration-for-different-structures",level:2},{value:"Details and Troubleshooting",id:"details-and-troubleshooting",level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Your Go applications must meet specific compilation requirements before you can submit them for scanning."),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://docs.veracode.com/r/r_supported_table"},"Supported Languages and Platforms")," for instructions for other platforms."),(0,o.kt)("p",null,"You can analyze applications using Veracode Static Analysis or Veracode Software Composition Analysis ","(","SCA",")"," upload and scan, if licensed. For SCA agent-based scan requirements, see ",(0,o.kt)("a",{parentName:"p",href:"https://docs.veracode.com/r/Using_Veracode_SCA_with_Programming_Languages"},"Using Veracode SCA with Programming Languages"),"."),(0,o.kt)("h2",{id:"supported-go-versions"},"Supported Go Versions"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Language"),(0,o.kt)("th",{parentName:"tr",align:null},"Version"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Go"),(0,o.kt)("td",{parentName:"tr",align:null},"1.20 and earlier")))),(0,o.kt)("h2",{id:"supported-go-frameworks-and-libraries"},"Supported Go Frameworks and Libraries"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Framework/Library"),(0,o.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Gorilla"),(0,o.kt)("td",{parentName:"tr",align:null},"Includes support for mux, handlers, HTTP, session, and additional Gorilla components")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Gin Web Framework (Gin-Gonic)"),(0,o.kt)("td",{parentName:"tr",align:null},"1.7.x")))),(0,o.kt)("h2",{id:"packaging-guidance-for-go"},"Packaging Guidance for Go"),(0,o.kt)("p",null,"Veracode uses functionality in the standard Go compiler when analyzing applications, and requires that the application is packaged in a structure that can be compiled. Package the source directory for a single compilable Go executable as a compressed ZIP archive, and structure it using these rules:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The ZIP archive must contain a single directory.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The top-level directory must include a GO file that contains a ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," call, in addition to any other Go source files that the main package uses. For information on specifying a different location for the ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," call, see ",(0,o.kt)("a",{parentName:"p",href:"#go_diff_structures"},"Configuration for Different Structures"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Veracode uses the vendoring functionality in Go to manage third-party libraries. When building an application with Go 1.11 or later, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"-mod=vendor")," option, or run the ",(0,o.kt)("inlineCode",{parentName:"p"},"go mod vendor")," command to create the vendor directory."),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"You must place any third-party libraries or other internal packages in a subdirectory named ",(0,o.kt)("inlineCode",{parentName:"li"},"vendor"),". For example: ",(0,o.kt)("inlineCode",{parentName:"li"},"vendor/github.com/my_org/my_application")),(0,o.kt)("li",{parentName:"ul"},"Any dependencies that the application uses must be in the vendor subdirectory.")),(0,o.kt)("p",{parentName:"li"},"For more information, see ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/golang/go/wiki/Modules#how-do-i-use-vendoring-with-modules-is-vendoring-going-away"},"How do I use vendoring with modules?")),(0,o.kt)("p",{parentName:"li"},"If the top-level directory contains a go.mod file, Veracode Static Analysis uses the ",(0,o.kt)("inlineCode",{parentName:"p"},"module")," directive to detect the module path. For example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"mymod")," folder in your application might include a ",(0,o.kt)("inlineCode",{parentName:"p"},"go.mod")," file that contains module ",(0,o.kt)("inlineCode",{parentName:"p"},"github.com/user/mymod"),". You can import ",(0,o.kt)("inlineCode",{parentName:"p"},"github.com/user/mymod/stringutil")," even if you archive only the ",(0,o.kt)("inlineCode",{parentName:"p"},"mymod")," folder, instead of the entire path ",(0,o.kt)("inlineCode",{parentName:"p"},"github.com/user/mymod"),"."),(0,o.kt)("p",{parentName:"li"},"For more information, see the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/golang/go/wiki/Modules#gomod"},"go.mod")," Wiki page.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The application must not include any cgo dependencies or build tags that restrict the application to running only on a specific operating system.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Any packages that the application uses that are specific to the application must be contained in a subdirectory inside the app directory."))),(0,o.kt)("p",null,"This example shows the structure of the submitted source files:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"app.zip\n|__ app/\n    |-- main.go\n    |-- [other *.go files in package main]\n    |-- [go.mod if used]\n    |__ applicationpkg1/\n        |-- [application package 1 *.go files]\n    |__ applicationpkg2/\n        |-- [application package 2 *.go files]\n    |__ vendor/ [first- and third-party dependencies go in this folder]\n\n")),(0,o.kt)("h2",{id:"software-composition-analysis-requirements"},"Software Composition Analysis Requirements"),(0,o.kt)("p",null,"If using Veracode Software Composition Analysis, follow the requirements for your package manager:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Dep")),(0,o.kt)("p",null,"Include ",(0,o.kt)("inlineCode",{parentName:"p"},"gopkg.lock")," in the root of your ZIP archive."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Glide")),(0,o.kt)("p",null,"Include ",(0,o.kt)("inlineCode",{parentName:"p"},"glide.lock")," in the root of your ZIP archive."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Go modules")),(0,o.kt)("p",null,"Include ",(0,o.kt)("inlineCode",{parentName:"p"},"go.sum")," in the root of your ZIP archive. Veracode recommends using Veracode SCA with Go version 1.14 or later so that it can use the content of the vendor directory to exclude non-vendored dependencies from scan results."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Godep")),(0,o.kt)("p",null,"Include ",(0,o.kt)("inlineCode",{parentName:"p"},"godeps/godeps.lock")," in the root of your ZIP archive."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Govendor")),(0,o.kt)("p",null,"Include ",(0,o.kt)("inlineCode",{parentName:"p"},"vendor/vendor.json")," in the root of your ZIP archive."),(0,o.kt)("h2",{id:"upload-requirements"},"Upload Requirements"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"An upload must only contain one Go module."),(0,o.kt)("li",{parentName:"ul"},"You must split a multi-module project into separate uploads.")),(0,o.kt)("p",null,"Veracode does not support uploading a source repository that includes the source for multiple discrete Go executables or multiple modules."),(0,o.kt)("p",null,"Veracode cannot analyze a Go module or package without a ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," function."),(0,o.kt)("a",{name:"go_diff_structures"}),(0,o.kt)("h2",{id:"configuration-for-different-structures"},"Configuration for Different Structures"),(0,o.kt)("p",null,"If the application you want to analyze has a package structure that does not match the upload requirements, you can include a file that describes the structure of the application."),(0,o.kt)("p",null,"In the root of the directory that you compress to form the ZIP archive, include a JSON file named ",(0,o.kt)("inlineCode",{parentName:"p"},"veracode.json"),", with these optional properties:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"MainRoot")),(0,o.kt)("p",null,"Describes the import path relative to the enclosing directory where the main package is located. For example, if the root folder is named ",(0,o.kt)("inlineCode",{parentName:"p"},"project"),", and the main file is in ",(0,o.kt)("inlineCode",{parentName:"p"},"project/cmd/main"),", then the value for this configuration field is ",(0,o.kt)("inlineCode",{parentName:"p"},"cmd/main"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"MainPkgName")),(0,o.kt)("p",null,"Describes if the name of the package containing the ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," function for the application is something other than ",(0,o.kt)("inlineCode",{parentName:"p"},"main"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"FirstParty")),(0,o.kt)("p",null,"Describes an array of import paths for first-party code that is located in the vendor directory."),(0,o.kt)("p",null,"This example shows of the ",(0,o.kt)("inlineCode",{parentName:"p"},"veracode.json")," configuration file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "MainRoot": "cmd/app1",\n    "MainPkgName": "app1",\n    "FirstParty": [\n        "github.company.com"\n    ]\n}\n')),(0,o.kt)("p",null,"This example shows the application structure that uses a configuration file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"app.zip\n|__ app/\n    |-- veracode.json [configuration file describing the structure]\n    |__ cmd/\n        |__ app1\n            |-- main.go\n    |__ vendor/ [first- and third-party dependencies go in this folder]\n        |__ golang.org/\n        |__ gopkg.in/\n        |__ github.com/\n            |__ my_company/\n                |__ firstpartypkg1/\n                |__ firstpartypkg2/\n            |__ 3rdparty\n\n")),(0,o.kt)("h2",{id:"details-and-troubleshooting"},"Details and Troubleshooting"),(0,o.kt)("p",null,"Veracode uses the Go compiler to generate syntax trees to analyze the applications. The submitted archive is unzipped to an empty workspace directory. The ",(0,o.kt)("inlineCode",{parentName:"p"},"$GOPATH")," environment variable is set to this workspace. Each directory in this workspace is scanned for a GO file containing a ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," function, to identify the main package to compile the application."),(0,o.kt)("p",null,"You can validate that the application compiles by running the ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies"},"go build")," command after unzipping the file into a blank directory, or by running the ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/cmd/vet/"},"go vet")," command on it to identify any issues with the structure of the directory and package layout. If the application is unable to compile after being unzipped into a blank directory, Veracode cannot analyze the application."),(0,o.kt)("p",null,"To better understand the use of the vendor folder, review the ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/cmd/go/"},"Go documentation"),"."),(0,o.kt)("p",null,"If your application includes vendor dependencies that contain code in languages other than Go, you should remove them with this command:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"find /<path>/app/vendor -type f -not -name '*.go' -delete")),(0,o.kt)("p",null,"Veracode scans only GO files that have the GO extension."),(0,o.kt)("p",null,"When creating an archive of a Go application on macOS, the folder compression process creates hidden ",(0,o.kt)("inlineCode",{parentName:"p"},"__MACOSX")," resource fork files that you must remove. To remove the hidden resource fork files:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Run ",(0,o.kt)("inlineCode",{parentName:"li"},"zipinfo my.zip")," on the Go application archive to view a list of its files."),(0,o.kt)("li",{parentName:"ol"},"Review the list of files to verify that all resource fork files are removed."),(0,o.kt)("li",{parentName:"ol"},"Remove resource fork files from an existing archive on macOS using this command: ",(0,o.kt)("inlineCode",{parentName:"li"},"zip -d my.zip __MACOSX/*"))))}u.isMDXComponent=!0}}]);