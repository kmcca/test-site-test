"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[38873],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(n),m=i,f=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(f,o(o({ref:t},l),{},{components:n})):a.createElement(f,o({ref:t},l))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:i,o[1]=c;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},98201:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>p});var a=n(87462),i=(n(67294),n(3905));const r={title:"Example Scripts for Scriptable Request Modification Authentication",slug:"/r/Example_Script_for_Scriptable_Request_Modification_Authentication"},o=void 0,c={unversionedId:"guides/dynamic_analysis/da_scan_apis/api_scan_config/api_scan_srm_script_examples/README",id:"guides/dynamic_analysis/da_scan_apis/api_scan_config/api_scan_srm_script_examples/README",title:"Example Scripts for Scriptable Request Modification Authentication",description:"Veracode API Scanning supports scriptable request modification (SRM) that enables you to modify API requests during authentication with remote hosts. To implement the SRM authentication option in your organization, you can use the example scripts in this section as a starting point.",source:"@site/docs/guides/10_dynamic_analysis/02_da_scan_apis/04_api_scan_config/02_api_scan_srm_script_examples/README.md",sourceDirName:"guides/10_dynamic_analysis/02_da_scan_apis/04_api_scan_config/02_api_scan_srm_script_examples",slug:"/r/Example_Script_for_Scriptable_Request_Modification_Authentication",permalink:"/km-docusaurus-test/r/Example_Script_for_Scriptable_Request_Modification_Authentication",draft:!1,tags:[],version:"current",frontMatter:{title:"Example Scripts for Scriptable Request Modification Authentication",slug:"/r/Example_Script_for_Scriptable_Request_Modification_Authentication"},sidebar:"tutorialSidebar",previous:{title:"API Scanning Authentication Methods",permalink:"/km-docusaurus-test/guides/dynamic_analysis/da_scan_apis/api_scan_config/API_Scanning_Authentication_Methods"},next:{title:"Example SRM Script for HMAC Signing",permalink:"/km-docusaurus-test/r/Example_SRM_Script_for_HMAC_Signing"}},s={},p=[{value:"SRM Script Requirements",id:"srm-script-requirements",level:2},{value:"Initial Function",id:"initial-function",level:3},{value:"Global Object and Scope",id:"global-object-and-scope",level:3}],l={toc:p};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.veracode.com/r/About_Veracode_API_Scanning"},"Veracode API Scanning")," supports scriptable request modification (SRM) that enables you to modify API requests during authentication with remote hosts. To implement the SRM authentication option in your organization, you can use the example scripts in this section as a starting point."),(0,i.kt)("p",null,"After you create the script file, you save it as a plain text JavaScript file and upload it in the Veracode Platform when ",(0,i.kt)("a",{parentName:"p",href:"https://docs.veracode.com/r/Configure_and_Run_an_API_Specification_Scan"},"configuring authentication for API Scanning"),". When you submit a scan request, Veracode does a one-time evaluation of the script to ensure it is valid and free of any errors."),(0,i.kt)("h2",{id:"srm-script-requirements"},"SRM Script Requirements"),(0,i.kt)("p",null,"SRM scripts have access to standard ",(0,i.kt)("a",{parentName:"p",href:"https://tc39.es/ecma262/"},"ECMAScript")," syntax, which is commonly referred to as JavaScript, but cannot load any external libraries. The scripts can reference and set objects in the global scope and these values are accessible to all requests. For example, a script can define constants that it reuses, or save a value during one request and then retrieve that value during a future request."),(0,i.kt)("h3",{id:"initial-function"},"Initial Function"),(0,i.kt)("p",null,"The script must define one initial function named ",(0,i.kt)("inlineCode",{parentName:"p"},"run()")," that accepts no parameters and returns no value. At runtime, every request calls this function one time. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"function run() {\n    // modification logic goes here\n}\n")),(0,i.kt)("h3",{id:"global-object-and-scope"},"Global Object and Scope"),(0,i.kt)("p",null,"The script context has a reference to a global object named ",(0,i.kt)("inlineCode",{parentName:"p"},"vc"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"vc")," object contains the values of any ",(0,i.kt)("a",{parentName:"p",href:"https://docs.veracode.com/r/Create_a_Credentials_Variable_for_Dynamic_Analysis_Login_Scripts_with_the_REST_API"},"user-defined credentials variables")," within an object named ",(0,i.kt)("inlineCode",{parentName:"p"},"variables"),". This example extracts the value mapped to a credentials variable with the name ",(0,i.kt)("inlineCode",{parentName:"p"},"API_KEY")," to a script variable named ",(0,i.kt)("inlineCode",{parentName:"p"},"key"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"function run() {\n    let key = vc.variables['API_KEY'];\n}\n")),(0,i.kt)("p",null,"When the ",(0,i.kt)("inlineCode",{parentName:"p"},"run()")," function is called, the current request is accessible in the global scope as a variable named ",(0,i.kt)("inlineCode",{parentName:"p"},"request"),". The script can extract the properties of the request from this object:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"function run() {\n    let headers = request.headers();\n    let uri = request.uri();\n}\n")))}u.isMDXComponent=!0}}]);